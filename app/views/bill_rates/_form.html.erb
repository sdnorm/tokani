
  <div>
    <% form_url = bill_rate.new_record? ? bill_rates_path : bill_rate_path(bill_rate) %>
    <%= form_with(model: bill_rate, url: form_url) do |form| %>
      <%= render "shared/error_messages", resource: form.object %>

      <div class="overflow-hidden bg-white shadow sm:rounded-lg">
        <div class="px-4 py-5 sm:px-6">
        </div>
        <div class="">
          <dl class="sm:divide-y sm:divide-gray-200">
            <div class="py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6">
              <div class="mt-1 lg:col-span-1 sm:col-span-2 sm:mt-0">
                <h3 class="text-base font-semibold leading-6 text-tokanisecondary-700">Name*</h3>
                <dt class="text-sm font-medium text-gray-500">Descriptive Name for your Bill Rate</dt>  
              </div>        
              <div class="mt-1 pl-4 pr-4 text-sm text-gray-900 col-span-2 sm:mt-0 pl-0">
                <%= form.hidden_field :account_id, value: current_account.id %>
                <%= form.text_field :name, class: "mt-3 block w-full rounded-md border border-slate-400 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div>
            </div>
            <div class="py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6">
              <div class="mt-1 lg:col-span-1 sm:col-span-2 sm:mt-0">
                <h3 class="text-base font-semibold leading-6 text-tokanisecondary-700">Hourly Bill Rate*</h3>
                <dt class="text-sm font-medium text-gray-500">This is the amount each Customer is billed per hour for each appointment.</dt>
              </div>
              <div class="mt-1 pl-4 pr-4 lg:col-span-1 sm:col-span-2 sm:mt-0 pl-0">
                <div class="relative flex h-10 w-full flex-row rounded-lg">  
                 
                 <%= form.text_field :hourly_bill_rate, class: "peer w-full rounded-l-lg border border-slate-400 px-2 text-slate-900 placeholder-slate-400 transition-colors duration-300 focus:border-tokanisecondary-400 focus:outline-none" %>
                  <span class="flex  items-center rounded-r-lg border border-slate-400 bg-tokanisecondary-100 px-2 text-sm text-slate-500 transition-colors duration-300 peer-focus:border-tokanisecondary-400 peer-focus:bg-tokanisecondary-400 peer-focus:text-white" for="domain">$/Hr</span>
                </div>
              </div>
            </div>
            
            <div class="py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6">
              <div class="mt-1 lg:col-span-1 sm:col-span-2 sm:mt-0">
                <h3 class="text-base font-semibold leading-6 text-tokanisecondary-700">Minimum Time Billed*</h3>
                <dt class="text-sm font-medium text-gray-500">The minimum time (in minutes) that is billed for each appointment.  If you have no minimum requirement, enter 0.</dt>
              </div>
              <div class="mt-1 pl-4 pr-4 lg:col-span-1 sm:col-span-2 sm:mt-0 pl-0">
                <div class="relative flex h-10 w-full flex-row rounded-lg">                      
                  <%= form.text_field :minimum_time_charged, class: "peer w-full rounded-l-lg border border-slate-400 px-2 text-slate-900 placeholder-slate-400 transition-colors duration-300 focus:border-tokanisecondary-400 focus:outline-none" %>
                  <span class="flex  items-center rounded-r-lg border border-slate-400 bg-tokanisecondary-100 px-2 text-sm text-slate-500 transition-colors duration-300 peer-focus:border-tokanisecondary-400 peer-focus:bg-tokanisecondary-400 peer-focus:text-white" for="domain">minutes</span>
                </div>
              </div>
            </div>

            <div class="py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6">
              <div class="mt-1 lg:col-span-1 sm:col-span-2 sm:mt-0">
                <h3 class="text-base font-semibold leading-6 text-tokanisecondary-700">Round Time*</h3>
                <dt class="text-sm font-medium text-gray-500">Rounds the duration of the appointment during billing calculation.</dt>
              </div>
              <div class="mt-1 pl-4 pr-4 lg:col-span-2 sm:col-span-2 sm:mt-0 pl-0">
                <div class="flex w-64">
                  <div class="select_br_left grow">
                    <%= form.select :round_time, options_for_select(round_time_options, bill_rate.round_time), {}, class: "flex items-center rounded-l-lg border border-slate-400 bg-tokanisecondary-100 px-2 text-sm text-slate-900 transition-colors duration-300 peer-focus/round:border-sky-400 peer-focus/round:bg-tokanisecondary-400 peer-focus/round:text-white" %>
                  </div> 
                  <div class="select_br_right grow">
                    <%= form.select :round_increment, options_for_select(round_increment_options, bill_rate.round_increment), {}, class:"peer/round w-full rounded-r-lg border border-slate-400 px-2 text-slate-900 placeholder-slate-400 transition-colors duration-300 focus:border-sky-400 focus:outline-none" %>
                  </div>
               </div>
              </div>
            </div>

            <div class="py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6">
              <div class="mt-1 lg:col-span-1 sm:col-span-2 sm:mt-0">
                <h3 class="text-base font-semibold leading-6 text-tokanisecondary-700">After Hours</h3>
                <dt class="text-sm font-medium text-gray-500">What time are <strong>normal business hours</strong>, and how much overage is billed for appointments outside of that timeframe.</dt>
              </div>
              <div class="mt-1 pl-4 pr-4 lg:col-span-2 sm:col-span-2 sm:mt-0 pl-0">
                <div class="select_br_right flex h-10  flex-row-reverse justify-end rounded-lg mb-5">

                  <%= select_hour bill_rate.end_hour(:regular_hours_end_seconds), { ampm: true, field_name: 'regular_hours_end_seconds[hour]', prefix: 'times', prompt: 'None' }, { id: dom_id(@bill_rate, 'times_end_hour'), class: "peer w-full rounded-r-lg border border-slate-400 px-2 text-slate-900 placeholder-slate-400 transition-colors duration-300 focus:border-sky-400 focus:outline-none"}  %>
                  <span class="flex items-center rounded-l-lg border border-slate-400 bg-tokanisecondary-100 px-2 text-sm text-slate-500 transition-colors duration-300 peer-focus:border-tokanisecondary-400 peer-focus:bg-tokanisecondary-400 peer-focus:text-white"> To </span>
                  &nbsp;&nbsp;
                  <%= select_hour bill_rate.start_hour(:regular_hours_start_seconds), { ampm: true, field_name: 'regular_hours_start_seconds[hour]', prefix: 'times', prompt: 'None' }, { id: dom_id(@bill_rate, 'times_start_hour'), class: "peer w-full rounded-r-lg border border-slate-400 px-2 text-slate-900 placeholder-slate-400 transition-colors duration-300 focus:border-sky-400 focus:outline-none"}  %>
                  <span class="peer flex items-center rounded-l-lg border border-slate-400 bg-tokanisecondary-100 px-2 text-sm text-slate-500 transition-colors duration-300 peer-focus:border-tokanisecondary-400 peer-focus:bg-tokanisecondary-400 peer-focus:text-white">FROM</span>
                       
                </div>
                <div class="flex h-10 flex-row w-64 rounded-lg">
                  <%= form.text_field  :after_hours_overage, class: "peer w-full rounded-l-lg border border-slate-400 px-2 text-slate-900 placeholder-slate-400 transition-colors duration-300 focus:border-tokanisecondary-400 focus:outline-none" %>
                  <span class="flex  items-center rounded-r-lg border border-slate-400 bg-tokanisecondary-100 px-2 text-sm text-slate-500 transition-colors duration-300 peer-focus:border-tokanisecondary-400 peer-focus:bg-tokanisecondary-400 peer-focus:text-white">$/Hr</span>
                  
                </div>
                
              </div>
            </div>
            <div class="py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6">
              <div class="mt-1 lg:col-span-1 sm:col-span-2 sm:mt-0">
                <h3 class="text-base font-semibold leading-6 text-tokanisecondary-700">Rush Rate</h3>
                <dt class="text-sm font-medium text-gray-500">What timeframe from scheduled appointment time is considered a rush rate, and how much is the overage charge for that.</dt>
              </div>
              <div class="mt-1 pl-4 pr-4 lg:col-span-2 sm:col-span-2 sm:mt-0 pl-0">
                <div class="flex h-10 flex-row rounded-lg mb-3">
                  <div class=" flex h-10  flex-row rounded-lg">
                    <%= form.text_field  :rush_overage, class: "peer w-full rounded-l-lg border border-slate-400 px-2 text-slate-900 placeholder-slate-400 transition-colors duration-300 focus:border-tokanisecondary-400 focus:outline-none" %>
                    <span class="flex  items-center rounded-r-lg border border-slate-400 bg-tokanisecondary-100 px-2 text-sm text-slate-500 transition-colors duration-300 peer-focus:border-tokanisecondary-400 peer-focus:bg-tokanisecondary-400 peer-focus:text-white">$/Hr</span>
                  </div>
                  &nbsp;&nbsp;
                  <div class="select_br flex h-10 grow flex-row rounded-lg">
                    <%= form.select :rush_overage_trigger, options_for_select(cancel_rate_trigger_options, bill_rate.rush_overage_trigger), {}, class:"peer w-full rounded-r-lg border border-slate-400 px-2 text-slate-900 placeholder-slate-400 transition-colors duration-300 focus:border-sky-400 focus:outline-none" %>
                  </div>
                </div>
              </div>
            </div>

            <div class="py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6">
              <div class="mt-1 lg:col-span-1 sm:col-span-2 sm:mt-0">
                <h3 class="text-base font-semibold leading-6 text-tokanisecondary-700">Cancel Rate</h3>
                <dt class="text-sm font-medium text-gray-500">What timeframe from scheduled appointment time is considered a cancel rate, and how much is the charge for that.</dt>
              </div>
              <div class="mt-1 pl-4 pr-4 lg:col-span-2 sm:col-span-2 sm:mt-0 pl-0">
                <div class="flex h-10 flex-row rounded-lg mb-3">
                  <div class=" flex h-10  flex-row rounded-lg">
                    <%= form.text_field  :cancel_rate, class: "peer w-full rounded-l-lg border border-slate-400 px-2 text-slate-900 placeholder-slate-400 transition-colors duration-300 focus:border-tokanisecondary-400 focus:outline-none" %>
                    <span class="flex  items-center rounded-r-lg border border-slate-400 bg-tokanisecondary-100 px-2 text-sm text-slate-500 transition-colors duration-300 peer-focus:border-tokanisecondary-400 peer-focus:bg-tokanisecondary-400 peer-focus:text-white">$/Hr</span>
                  </div>
                  &nbsp;&nbsp;
                  <div class="select_br flex h-10 grow flex-row rounded-lg">
                    <%= form.select :cancel_rate_trigger, options_for_select(rush_overage_trigger_options, bill_rate.rush_overage_trigger), {}, class:"peer w-full rounded-r-lg border border-slate-400 px-2 text-slate-900 placeholder-slate-400 transition-colors duration-300 focus:border-sky-400 focus:outline-none" %>
                   
                  </div>
                </div>
              </div>
            </div>

            <div class="py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6">
              <div class="mt-1 lg:col-span-1 sm:col-span-2 sm:mt-0">
                <h3 class="text-base font-semibold leading-6 text-tokanisecondary-700">Modalities*</h3>
                <dt class="text-sm font-medium text-gray-500">Check all appointment modalities that this bill rate applies to.</dt>
              </div>
              <div class="mt-1 pr-4 lg:col-span-2 sm:col-span-2 sm:mt-0 pl-0">
                <fieldset class="space-y-2">
                  <div class="relative flex ">
                    <div class="flex h-5 items-center">
                      <%= form.check_box :in_person, class:"h-4 w-4 m-4 rounded border-gray-300 text-tokanisecondary-400 focus:ring-tokanisecondary-400" %>
                      <%= form.label :in_person, class:"font-medium text-gray-700 mr-3" %>
                      <%= form.check_box :video, class:"h-4 w-4 m-4 rounded border-gray-300 text-tokanisecondary-400 focus:ring-tokanisecondary-400" %>
                      <%= form.label :video, class:"font-medium text-gray-700 mr-3" %> 
                      <%= form.check_box :phone, class:"h-4 w-4 m-4 rounded border-gray-300 text-tokanisecondary-400 focus:ring-tokanisecondary-400" %>
                      <%= form.label :phone, class:"font-medium text-gray-700 mr-3" %>
                    </div>
                  </div>
                  
                </fieldset>
              </div>
            </div>
            <div class="py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6">
              <div class="mt-1 lg:col-span-1 sm:col-span-2 sm:mt-0">
                <h3 class="text-base font-semibold leading-6 text-tokanisecondary-700">Active Status*</h3>
                <dt class="text-sm font-medium text-gray-500">Make this rate active to have it apply to billing calculations.</dt>
              </div>
              <div class="mt-1 pr-4 lg:col-span-2 sm:col-span-2 sm:mt-0 pl-0">
                <fieldset class="space-y-2">
                  <div class="relative flex ">
                    <div class="flex h-5 items-center">
                      <div class="flex h-5 items-center">
                        <%= form.check_box :is_active, class:"h-4 w-4 m-4 rounded border-gray-300 text-tokanisecondary-400 focus:ring-tokanisecondary-400" %>
                        <%= form.label :is_active, class:"font-medium text-gray-700 mr-3" %>
                      </div>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>

            <div data-controller="radio-button" >
            <div class="py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6">
              <div class="mt-1 lg:col-span-1 sm:col-span-2 sm:mt-0">
                <h3 class="text-base font-semibold leading-6 text-tokanisecondary-700">Default Rate*</h3>
                <dt class="text-sm font-medium text-gray-500">Check to make this the default bill rate for the modalities selected.</dt>
              </div>
              <div class="mt-1 pr-4 lg:col-span-2 sm:col-span-2 sm:mt-0 pl-0">
                <fieldset class="space-y-2">
                  <div class="relative flex ">
                    <div class="flex h-5 items-center">
                      <div data-controller="popover" data-popover-translate-x="0" data-popover-translate-y="-128%" data-action="mouseover->popover#mouseOver mouseout->popover#mouseOut">
                        <div class="content hidden absolute max-w-xs bg-slate-200 shadow-lg rounded p-2 inline-block inline-block rounded px-7 pt-3 pb-2.5 text-sm font-bold uppercase leading-normal text-tokanisecondary-400 transition duration-150 ease-in-out" data-popover-target="content">
                          Changing langauage specific rate to default will remove languages from rate.
                        </div>
                        <div  class="flex h-5 items-center" id="default_rate">
                          <%= form.radio_button :default_rate, true, class: 'h-4 w-4 m-4 rounded border-gray-300 text-tokanisecondary-400 focus:ring-tokanisecondary-400', data: {action: "click->radio-button#selectFieldset", radio_button_fieldset_param: "default_rate"} %>
                          <%= form.label :is_default, class:"font-medium text-gray-700 mr-3" %>
                          <%= form.radio_button :default_rate, false, class: 'h-4 w-4 m-4 rounded border-gray-300 text-tokanisecondary-400 focus:ring-tokanisecondary-400', data: {action: "click->radio-button#selectFieldset", radio_button_fieldset_param: "language_rate"} %>
                          <%= form.label :is_language_specific, class:"font-medium text-gray-700 mr-3" %>   
                        </div>
                      </div>
                    </div>
                  </div>  
                </fieldset>
              </div>
            </div>
            

            

            <div class="py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6">
              <div class="mt-1 lg:col-span-1 sm:col-span-2 sm:mt-0">
                <h3 class="text-base font-semibold leading-6 text-tokanisecondary-700">Langugage Specific Rate*</h3>
                <dt class="text-sm font-medium text-gray-500">If your rate is not a defaulat rate, please select which languges it will apply to.</dt>
                <%= hidden_field_tag "#{form.object_name}[language_ids][]", '' %>
              </div>
              <div class="mt-1 pr-4 lg:col-span-2 sm:col-span-2 sm:mt-0 pl-0">
                <%= field_set_tag nil, id: 'language_rate', class: 'mb-3', disabled: @languages_disabled, data: {radio_button_target: "fieldset"} do %>
                <div id="languages" data-controller="multiselect" data-multiselect-items-value='<%= @languages_json %>' data-placeholder="Select Languages for this Bill Rate" <%= raw selected_languages(bill_rate.new_record?, @br_languages_json) %>>
                  <select multiple="multiple" class="hidden multiselect__hidden" data-multiselect-target="hidden" name="bill_rate[language_ids][]" id="bill_rate_language_ids" style="display: none;"></select>
              </div>
                </div>
                <% end %>
              </div>
            </div>

            <div class="py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6">
              <div class="mt-1 lg:col-span-1 sm:col-span-2 sm:mt-0">
                <h3 class="text-base font-semibold leading-6 text-tokanisecondary-700">Apply Rate to Customers*</h3>
                <dt class="text-sm font-medium text-gray-500">Select which of your customers will use this rate.</dt>
              </div>
              <div class="mt-1 pr-4 lg:col-span-2 sm:col-span-2 sm:mt-0 pl-0">
                <div data-controller="multiselect" data-multiselect-items-value='<%= @customers_json %>' data-placeholder="Select Customers for this Bill Rate" <%= raw selected_customers(bill_rate.new_record?, @br_customers_json) %>>
                  <select multiple="multiple" class="hidden multiselect__hidden" data-multiselect-target="hidden" name="bill_rate[customer_ids][]" id="bill_rate_customer_ids" style="display: none;"></select>
                  <%= hidden_field_tag "#{form.object_name}[customer_ids][]", '' %>
                </div>
              </div>
            </div>
            
          
  
            <div class="bg-gray-50 mt-4 px-4 py-3 text-right sm:px-6">
                <%= form.button button_text(form.send(:submit_default_value)), class:"inline-flex justify-center rounded-md border border-transparent bg-tokanisecondary-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-tokanisecondary-700 focus:outline-none focus:ring-2 focus:ring-tokanisecondary-500 focus:ring-offset-2" %>
                <% if form.object.new_record? %>
                    <%= link_to t("cancel"), bill_rates_path, class:"inline-flex justify-center rounded-md border border-transparent bg-tokaniprimary-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-tokanisecondary-700 focus:outline-none focus:ring-2 focus:ring-tokanisecondary-500 focus:ring-offset-2" %>
                <% else %>
                    <%= link_to t("cancel"), bill_rate_path(@bill_rate), class: "btn btn-white" %>
                <% end %>
            </div>
          </div>
        </div>
  <% end %>
  </div>
  

  