<div>
  <% form_url = pay_bill_rate.new_record? ? pay_bill_rates_path : pay_bill_rate_path(pay_bill_rate) %>
  <%= form_with(model: pay_bill_rate, url: form_url) do |form| %>
    <%= render "shared/error_messages", resource: form.object %>
    
      <div class="mt-5 md:col-span-2 md:mt-0">
        <div class="overflow-hidden shadow sm:rounded-md">
          <div class="bg-white px-4 py-5 sm:p-6">
            <div class="grid grid-cols-6 gap-6">
              <div class="col-span-6 sm:col-span-6 lg:col-span-3">
                  <%= form.label :name, class: "block text-sm font-medium text-gray-700" %>
                  <%= form.text_field :name, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div>
              <div class="col-span-6 sm:col-span-3 lg:col-span-3">
                <div class="form-group">
                  <%= form.label :effective_date, class:" block text-sm font-medium text-gray-700" %>
                  <%= form.text_field :effective_date, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm", data: {controller: "flatpickr"} %>
                </div>
              </div>
              <div class="col-span-6 sm:col-span-6 lg:col-span-3">
                  <%= form.label :bill_rate, class: "block text-sm font-medium text-gray-700" %>
                  <%= form.text_field :bill_rate, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div>
              <div class="col-span-6 sm:col-span-3 lg:col-span-3">
                  <%= form.label :pay_rate, class: "block text-sm font-medium text-gray-700" %>
                  <%= form.text_field :pay_rate, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div>
              <div class="col-span-6 sm:col-span-6 lg:col-span-3">
                  <%= form.label  :after_hours_bill_rate, class: "block text-sm font-medium text-gray-700" %>
                  <%= form.text_field  :after_hours_bill_rate, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div>
              <div class="col-span-6 sm:col-span-6 lg:col-span-3">
                  <%= form.label  :after_hours_pay_rate, class: "block text-sm font-medium text-gray-700" %>
                  <%= form.text_field  :after_hours_pay_rate, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div>
              <div class="col-span-6 sm:col-span-6 lg:col-span-3">
                  <%= form.label :rush_bill_rate, class: "block text-sm font-medium text-gray-700" %>
                  <%= form.text_field :rush_bill_rate, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div>
              <div class="col-span-6 sm:col-span-6 lg:col-span-3">
                  <%= form.label :rush_pay_rate, class: "block text-sm font-medium text-gray-700" %>
                  <%= form.text_field :rush_pay_rate, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div>
              <div class="col-span-6 sm:col-span-6 lg:col-span-3">
                  <%= form.label :discount_bill_rate, class: "block text-sm font-medium text-gray-700" %>
                  <%= form.text_field :discount_bill_rate, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div>
              <div class="col-span-6 sm:col-span-6 lg:col-span-3">
                  <%= form.label :discount_pay_rate, class: "block text-sm font-medium text-gray-700" %>
                  <%= form.text_field :discount_pay_rate, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div>
              <div class="col-span-6 sm:col-span-6 lg:col-span-3">
                  <%= form.label :cancel_level_1_bill_rate, class: "block text-sm font-medium text-gray-700" %>
                  <%= form.text_field :cancel_level_1_bill_rate, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div>  
              <div class="col-span-6 sm:col-span-6 lg:col-span-3">
                <%= form.label :cancel_level_1_pay_rate, class: "block text-sm font-medium text-gray-700" %>
                <%= form.text_field :cancel_level_1_pay_rate, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div> 
              <div class="col-span-6 sm:col-span-6 lg:col-span-3">
                <%= form.label :cancel_level_2_bill_rate, class: "block text-sm font-medium text-gray-700" %>
                <%= form.text_field :cancel_level_2_bill_rate, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div> 
              <div class="col-span-6 sm:col-span-6 lg:col-span-3">
                <%= form.label :cancel_level_2_pay_rate, class: "block text-sm font-medium text-gray-700" %>
                <%= form.text_field :cancel_level_2_pay_rate, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div> 

              <div class="col-span-6 sm:col-span-6 lg:col-span-3">
                <%= form.label :mileage_rate, class: "block text-sm font-medium text-gray-700" %>
                <%= form.text_field :mileage_rate, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div> 
              <div class="col-span-6 sm:col-span-6 lg:col-span-3">
                <%= form.label :travel_time_rate, class: "block text-sm font-medium text-gray-700" %>
                <%= form.text_field :travel_time_rate, class: "mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-tokanisecondary-500 focus:outline-none focus:ring-tokanisecondary-500 sm:text-sm" %>
              </div> 
            <!-- </div> -->
            <div class="col-span-6 sm:col-span-6 lg:col-span-3">
              <fieldset class="space-y-5">
                <legend class="sr-only">Pay/Bill Rate Modalitites</legend>
                <div class="relative flex items-start">
                  <div class="flex h-5 items-center">
                    <%= form.check_box :in_person, class:"h-4 w-4 rounded border-gray-300 text-tokanisecondary-600 focus:ring-tokanisecondary-500" %>  
                  </div>
                  <div class="ml-3 text-sm">
                    <%= form.label :in_person, class:"font-medium text-gray-700" %>
                    <p id="in_person_rate" class="text-gray-500">This rate applies to in-person appointments.</p>
                  </div> 
                </div>
                <div class="relative flex items-start">
                  <div class="flex h-5 items-center">
                    <%= form.check_box :video, class:"h-4 w-4 rounded border-gray-300 text-tokanisecondary-600 focus:ring-tokanisecondary-500" %>
                  </div>
                  <div class="ml-3 text-sm">
                    <%= form.label :video, class:"font-medium text-gray-700" %>
                    <p id="video_rate" class="text-gray-500">This rate applies to video appointments.</p>
                  </div>
                </div>
                <div class="relative flex items-start">
                    <div class="flex h-5 items-center">
                      <%= form.check_box :phone, class:"h-4 w-4 rounded border-gray-300 text-tokanisecondary-600 focus:ring-tokanisecondary-500" %>
                    </div>
                    <div class="ml-3 text-sm">
                      <%= form.label :phone, class:"font-medium text-gray-700" %>
                      <p id="phone_rate" class="text-gray-500">This rate applies to phone appointments.</p>
                    </div>
                </div>
              </fieldset>
            </div>

            <div class="col-span-6 sm:col-span-6 lg:col-span-3">
              <fieldset class="space-y-5">
                <legend class="sr-only">Defaults</legend>
                <div class="relative flex items-start">
                  <div class="flex h-5 items-center">
                    <%= form.check_box :is_active, class:"h-4 w-4 rounded border-gray-300 text-tokanisecondary-600 focus:ring-tokanisecondary-500" %>
                  </div>
                  <div class="ml-3 text-sm">
                    <%= form.label :is_active, class:"font-medium text-gray-700" %>
                    <p id="active" class="text-gray-500">This rate is active.</p>
                  </div>
                </div>
                <div class="relative flex items-start">
                  <div class="flex h-5 items-center">
                    <%= form.check_box :is_default, class:"h-4 w-4 rounded border-gray-300 text-tokanisecondary-600 focus:ring-tokanisecondary-500" %>
                  </div>
                  <div class="ml-3 text-sm">
                    <%= form.label :is_default, class:"font-medium text-gray-700" %>
                    <p id="default" class="text-gray-500">This rate is a default rate.</p>
                  </div>
                </div>
              </fieldset>
            </div>

            <div class="col-span-6 sm:col-span-6 lg:col-span-6">
              <div class="relative">
                <div class="absolute inset-0 flex items-center" aria-hidden="true">
                  <div class="w-full border-t border-tokaniaccent-300"></div>
                </div>
                <div class="relative flex justify-center">
                  <span class="bg-white px-2 text-lg text-tokaniprimary-600">Optional</span>
                </div>
              </div>
            </div>

            <div class="col-span-6 sm:col-span-6 lg:col-span-3">
              <dt class="text-md font-medium text-tokanisecondary-500">Select Interpreter Type(s)</dt>
              <dd  class="mt-3 text-sm text-gray-900">
                <% InterpreterDetail.interpreter_types.each do |int_type, id| %>
                <div class="relative flex items-start mt-1">
                  <div class="flex h-5 items-center">
                    <%= check_box_tag 'pay_bill_rate[interpreter_type_ids][]', id, @pay_bill_rate.interpreter_type_ids&.include?(id.to_s), class:"h-4 w-4 rounded border-gray-300 text-tokanisecondary-600 focus:ring-tokanisecondary-500" %>
                  </div>
                  <div class="ml-3 text-sm">
                    <%= int_type.titleize %>
                    <br>
                  </div>
                </div>
                <% end %>
              </dd>
            </div>
          
            <div class="col-span-6 sm:col-span-6 lg:col-span-3">
              <dt class="text-md font-medium text-tokanisecondary-500">Select Specialties</dt>
              <dd  class="mt-3 text-sm text-gray-900">
                  <% @pay_bill_rate.specialties.each do |pbs| %>
                  <div class="relative flex items-start mt-1">
                    <div class="flex h-5 items-center">
                      <%= check_box_tag 'pay_bill_rate[specialty_ids][]', pbs.id, true, class:"h-4 w-4 rounded border-gray-300 text-tokanisecondary-600 focus:ring-tokanisecondary-500" %>
                    </div>
                    <div class="ml-3 text-sm">
                      <%= pbs.name %>
                      <br>
                    </div>
                  </div>
                  <% end %>
                <% if @specialties.any? %>
                  <% @specialties.each do |specialty| %>
                    <% next if @pay_bill_rate.specialties.include?(specialty) %>
                    <div class="relative flex items-start mt-1">
                      <div class="flex h-5 items-center">
                        <%= check_box_tag 'pay_bill_rate[specialty_ids][]', specialty.id, false, class:"h-4 w-4 rounded border-gray-300 text-tokanisecondary-600 focus:ring-tokanisecondary-500" %>
                      </div>
                      <div class="ml-3 text-sm">
                        <%= specialty.name %>
                        <br>
                      </div>
                    </div>
                  <% end %>
                <% else %>
                  <p class="text-gray-500">This account does not have any specialties.</p>
                <% end %>   
              </dd>
            </div>
            

            <div class="col-span-6 sm:col-span-6 lg:col-span-3">
              <dt class="text-md font-medium text-tokanisecondary-500">Select Language</dt>
              <dd class="mt-3 text-sm text-gray-900">  
                <% @pay_bill_rate.languages.each do |pbl| %>
                  <div class="relative flex items-start mt-1">
                    <div class="flex h-5 items-center">
                      <%= check_box_tag 'pay_bill_rate[language_ids][]', pbl.id, true, class:"h-4 w-4 rounded border-gray-300 text-tokanisecondary-600 focus:ring-tokanisecondary-500" %>
                    </div>
                    <div class="ml-3 text-sm">
                      <%= pbl.name %>
                      <br>
                    </div>
                  </div>  
                <% end %>  

                <% @languages.each do |lang| %>
                  <% next if @pay_bill_rate.languages.include?(lang) %>
                  <div class="relative flex items-start mt-1">
                    <div class="flex h-5 items-center">
                      <%= check_box_tag 'pay_bill_rate[language_ids][]', lang.id, false, class:"h-4 w-4 rounded border-gray-300 text-tokanisecondary-600 focus:ring-tokanisecondary-500" %>
                    </div>
                    <div class="ml-3 text-sm">
                      <%= lang.name %>
                      <br>
                    </div>
                  </div>  
                <% end %>   
              </dd>
            </div>

            <div class="col-span-6 sm:col-span-6 lg:col-span-3">
              <div data-controller="pay-bill-rate-customer">
                <dt class="text-md font-medium text-tokanisecondary-500">Select Customer</dt>
                <dd class="mt-3 text-sm text-gray-900">  
                  <%= form.select :account_ids, options_from_collection_for_select(@customers, 'id', 'name', selected: @customer&.id), {prompt: "(Select Customer)"}, { data: {action: 'change->pay-bill-rate-customer#customerSelected' }, class: 'form-select' } %>
              
                  <div data-pay-bill-rate-customer-target="sites" class="<%= 'hidden' unless @sites&.any? %>">
                    <%= render template: 'sites/dropdown' %>
                  </div>

                  <div data-pay-bill-rate-customer-target="departments" class="<%= 'hidden' unless @departments&.any? %>">
                    <%= render template: 'sites/departments_dropdown' %>
                  </div>
                </dd>
              </div>
            </div>
          </div>
        </div>
          <div class="bg-gray-50 mt-4 px-4 py-3 text-right sm:px-6">
              <%= form.button button_text(form.send(:submit_default_value)), class:"inline-flex justify-center rounded-md border border-transparent bg-tokanisecondary-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-tokanisecondary-700 focus:outline-none focus:ring-2 focus:ring-tokanisecondary-500 focus:ring-offset-2" %>
              <% if form.object.new_record? %>
                  <%= link_to t("cancel"), pay_bill_rates_path, class:"inline-flex justify-center rounded-md border border-transparent bg-tokaniprimary-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-tokanisecondary-700 focus:outline-none focus:ring-2 focus:ring-tokanisecondary-500 focus:ring-offset-2" %>
              <% else %>
                  <%= link_to t("cancel"), pay_bill_rate_path(@pay_bill_rate), class: "btn btn-white" %>
              <% end %>
          </div>
        </div> 
      </div>
<% end %>
</div>


